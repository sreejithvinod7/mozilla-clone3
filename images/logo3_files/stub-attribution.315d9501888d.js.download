"undefined"==typeof window.Mozilla&&(window.Mozilla={}),function(){"use strict";window.dataLayer=window.dataLayer||[];var t={COOKIE_CODE_ID:"moz-stub-attribution-code",COOKIE_SIGNATURE_ID:"moz-stub-attribution-sig",DLSOURCE:"mozorg"};t.experimentName,t.experimentVariation,t.successCallback,t.timeoutCallback,t.requestComplete=!1,t.withinAttributionRate=function(){return Math.random()<t.getAttributionRate()},t.getAttributionRate=function(){var t=document.getElementsByTagName("html")[0].getAttribute("data-stub-attribution-rate");return isNaN(t)||!t?0:Math.min(Math.max(parseFloat(t),0),1)},t.hasCookie=function(){return Mozilla.Cookies.hasItem(t.COOKIE_CODE_ID)&&Mozilla.Cookies.hasItem(t.COOKIE_SIGNATURE_ID)},t.setCookie=function(e){if(e.attribution_code&&e.attribution_sig){var n=new Date;n.setTime(n.getTime()+864e5);var o=n.toUTCString();Mozilla.Cookies.setItem(t.COOKIE_CODE_ID,e.attribution_code,o,"/",undefined,!1,"lax"),Mozilla.Cookies.setItem(t.COOKIE_SIGNATURE_ID,e.attribution_sig,o,"/",undefined,!1,"lax")}},t.getCookie=function(){return{attribution_code:Mozilla.Cookies.getItem(t.COOKIE_CODE_ID),attribution_sig:Mozilla.Cookies.getItem(t.COOKIE_SIGNATURE_ID)}},t.updateBouncerLinks=function(e){if(e.attribution_code&&e.attribution_sig&&t.meetsRequirements())for(var n=document.querySelectorAll(".download-link"),o=0;o<n.length;o++){var i,a,r=n[o];r.href&&(-1!==r.href.indexOf("https://download.mozilla.org")||-1!==r.href.indexOf("https://bouncer-bouncer.stage.mozaws.net/"))||-1!==r.href.indexOf("https://dev.bouncer.nonprod.webservices.mozgcp.net")?((i=r.getAttribute("data-download-version"))&&/win/.test(i)&&(r.href=Mozilla.StubAttribution.appendToDownloadURL(r.href,e)),i&&/osx/.test(i)&&!/product=firefox-esr/.test(r.href)&&(r.href=Mozilla.StubAttribution.appendToDownloadURL(r.href,e))):r.href&&-1!==r.href.indexOf("/firefox/download/thanks/")&&(a=r.getAttribute("data-direct-link"))&&r.setAttribute("data-direct-link",Mozilla.StubAttribution.appendToDownloadURL(a,e))}},t.appendToDownloadURL=function(t,e){if(!e.attribution_code||!e.attribution_sig)return t;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&("attribution_code"!==n&&"attribution_sig"!==n||(t+=(t.indexOf("?")>-1?"&":"?")+n+"="+e[n]));return t},t.onRequestSuccess=function(e){e.attribution_code&&e.attribution_sig&&!t.requestComplete&&(t.updateBouncerLinks(e),t.setCookie(e),t.requestComplete=!0,"function"==typeof t.successCallback&&t.successCallback())},t.onRequestTimeout=function(){t.requestComplete||(t.requestComplete=!0,"function"==typeof t.timeoutCallback&&t.timeoutCallback())},t.requestAuthentication=function(e){var n=window.location.protocol+"//"+window.location.host+"/en-US/firefox/stub_attribution_code/",o=new window.XMLHttpRequest,i=setTimeout(t.onRequestTimeout,1e4);o.open("GET",n+"?"+window._SearchParams.objectToQueryString(e)),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.onreadystatechange=function(){if(4===o.readyState){var e=o.status;if(e&&e>=200&&e<400)try{var n=JSON.parse(o.responseText);clearTimeout(i),t.onRequestSuccess(n)}catch(a){t.onRequestTimeout()}}},o.timeout=1e4,o.send()},t.getUserAgent=function(t){return t=void 0!==t?t:navigator.userAgent,/MSIE|Trident/i.test(t)?"ie":/Edg|Edge/i.test(t)?"edge":/Firefox/.test(t)?"firefox":/Chrome/.test(t)?"chrome":"other"},t.getGtagClientID=function(t){t=void 0!==t?t:window.dataLayer;var e=null;function n(t){for(var o in t)if("object"==typeof t[o]&&Object.prototype.hasOwnProperty.call(t,o)){if("gtagApiResult"===o){if("string"!=typeof t[o].client_id)return e;e=t[o].client_id;break}n(t[o])}}try{"object"==typeof t&&t.forEach((function(t){n(t)}))}catch(o){return window.dataLayer.push({event:"log",label:"getGtagClientID error: "+o}),null}return e},t.createSessionID=function(){return Math.floor(1e9+9e9*Math.random()).toString()},t.waitForGoogleAnalyticsThen=function(e){var n,o=0;!function i(){clearTimeout(n);var a=t.getGtagClientID();a?e(!0):o<=20?(o+=1,n=window.setTimeout(i,100)):e(!!a)}()},t.getAttributionData=function(e,n){var o=new window._SearchParams,i=o.utmParams(),a=n?null:o.get("experiment")||t.experimentName,r=n?null:o.get("variation")||t.experimentVariation,u="string"==typeof e?e:document.referrer,s=n?"other":t.getUserAgent(),l=n?null:t.getGtagClientID(),d={utm_source:i.utm_source,utm_medium:i.utm_medium,utm_campaign:i.utm_campaign,utm_content:i.utm_content,referrer:u,ua:s,experiment:a,variation:r,client_id_ga4:l,session_id:l?t.createSessionID():null,dlsource:t.DLSOURCE};for(var c in d)Object.prototype.hasOwnProperty.call(d,c)&&("undefined"!=typeof d[c]&&null!==d[c]||delete d[c]);return d},t.hasValidData=function(t){if("string"==typeof t.utm_content&&"string"==typeof t.referrer){var e=t.utm_content;if(e.length>150)return!1;for(;-1!==e.indexOf("%");)try{var n=decodeURIComponent(e);if(n===e)break;e=n}catch(o){break}if(/^rta:/.test(e)&&-1===t.referrer.indexOf("https://addons.mozilla.org"))return!1}return!0},t.isFirefoxDownloadThanks=function(t){return(t=void 0!==t?t:window.location.href).indexOf("/firefox/download/thanks/")>-1},t.meetsRequirements=function(){return"undefined"!=typeof window.site&&"undefined"!=typeof Mozilla.Cookies&&"undefined"!=typeof window._SearchParams&&!!Mozilla.Cookies.enabled()&&!!/windows|osx/i.test(window.site.platform)},t.init=function(e,n){var o={};t.meetsRequirements()&&("function"==typeof e&&(t.successCallback=e),"function"==typeof n&&(t.timeoutCallback=n),t.hasCookie()?(o=t.getCookie(),t.updateBouncerLinks(o)):t.isFirefoxDownloadThanks()||t.waitForGoogleAnalyticsThen((function(){(o=t.getAttributionData())&&t.withinAttributionRate()&&t.hasValidData(o)&&(t.requestAuthentication(o),o.client_id_ga4&&window.dataLayer.push({event:"stub_session_set",id:o.session_id}))})))},window.Mozilla.StubAttribution=t}(),function(){"use strict";var t="moz-consent-pref";function e(){try{return JSON.parse(window.Mozilla.Cookies.getItem(t))}catch(e){return!1}}var n={handleConsent:function(t){t.detail.analytics&&(window.Mozilla.StubAttribution.init(),window.removeEventListener("mozConsentStatus",n.handleConsent,!1))},init:function(){var t;if(!("function"==typeof window.Mozilla.gpcEnabled&&window.Mozilla.gpcEnabled()||"function"==typeof window.Mozilla.dntEnabled&&window.Mozilla.dntEnabled()))if((t=document.getElementsByTagName("html")[0].getAttribute("data-needs-consent"))&&"true"===t.toLowerCase()){var o=e();window.Mozilla.StubAttribution.isFirefoxDownloadThanks()&&o&&o.analytics?window.Mozilla.StubAttribution.init():window.addEventListener("mozConsentStatus",n.handleConsent,!1)}else{var i=e();if(i&&!i.analytics)return;window.Mozilla.StubAttribution.init()}}};n.init()}();